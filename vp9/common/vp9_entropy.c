/*
 *  Copyright (c) 2010 The WebM project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree. An additional intellectual property rights grant can be found
 *  in the file PATENTS.  All contributing project authors may
 *  be found in the AUTHORS file in the root of the source tree.
 */


#include <stdio.h>

#include "vp9/common/vp9_entropy.h"
#include "string.h"
#include "vp9/common/vp9_blockd.h"
#include "vp9/common/vp9_onyxc_int.h"
#include "vp9/common/vp9_entropymode.h"
#include "vpx_mem/vpx_mem.h"

#define uchar unsigned char     /* typedefs can clash */
#define uint  unsigned int

typedef const uchar cuchar;
typedef const uint cuint;

typedef vp9_prob Prob;

#include "vp9/common/vp9_coefupdateprobs.h"

const int vp9_i8x8_block[4] = {0, 2, 8, 10};

DECLARE_ALIGNED(16, const unsigned char, vp9_norm[256]) = {
  0, 7, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4,
  3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
};

DECLARE_ALIGNED(16, const int, vp9_coef_bands[16]) = {
  0, 1, 2, 3, 6, 4, 5, 6, 6, 6, 6, 6, 6, 7, 7, 7
};

DECLARE_ALIGNED(16, cuchar, vp9_prev_token_class[MAX_ENTROPY_TOKENS]) = {
  0, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 0
};

DECLARE_ALIGNED(16, const int, vp9_default_zig_zag1d[16]) = {
  0,  1,  4,  8,
  5,  2,  3,  6,
  9, 12, 13, 10,
  7, 11, 14, 15,
};

DECLARE_ALIGNED(16, const int, vp9_col_scan[16]) = {
  0, 4,  8, 12,
  1, 5,  9, 13,
  2, 6, 10, 14,
  3, 7, 11, 15
};

DECLARE_ALIGNED(16, const int, vp9_row_scan[16]) = {
  0,   1,  2,  3,
  4,   5,  6,  7,
  8,   9, 10, 11,
  12, 13, 14, 15
};

DECLARE_ALIGNED(64, const int, vp9_coef_bands_8x8[64]) = { 0, 1, 2, 3, 5, 4, 4, 5,
  5, 3, 6, 3, 5, 4, 6, 6,
  6, 5, 5, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7
};

DECLARE_ALIGNED(64, const int, vp9_default_zig_zag1d_8x8[64]) = {
  0,  1,  8, 16,  9,  2,  3, 10, 17, 24, 32, 25, 18, 11,  4,  5,
  12, 19, 26, 33, 40, 48, 41, 34, 27, 20, 13,  6,  7, 14, 21, 28,
  35, 42, 49, 56, 57, 50, 43, 36, 29, 22, 15, 23, 30, 37, 44, 51,
  58, 59, 52, 45, 38, 31, 39, 46, 53, 60, 61, 54, 47, 55, 62, 63,
};

// Table can be optimized.
DECLARE_ALIGNED(16, const int, vp9_coef_bands_16x16[256]) = {
  0, 1, 2, 3, 5, 4, 4, 5, 5, 3, 6, 3, 5, 4, 6, 6,
  6, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
};

DECLARE_ALIGNED(16, const int, vp9_default_zig_zag1d_16x16[256]) = {
  0,   1,  16,  32,  17,   2,   3,  18,
  33,  48,  64,  49,  34,  19,   4,   5,
  20,  35,  50,  65,  80,  96,  81,  66,
  51,  36,  21,   6,   7,  22,  37,  52,
  67,  82,  97, 112, 128, 113,  98,  83,
  68,  53,  38,  23,   8,   9,  24,  39,
  54,  69,  84,  99, 114, 129, 144, 160,
  145, 130, 115, 100,  85,  70,  55,  40,
  25,  10,  11,  26,  41,  56,  71,  86,
  101, 116, 131, 146, 161, 176, 192, 177,
  162, 147, 132, 117, 102,  87,  72,  57,
  42,  27,  12,  13,  28,  43,  58, 73,
  88, 103, 118, 133, 148, 163, 178, 193,
  208, 224, 209, 194, 179, 164, 149, 134,
  119, 104,  89,  74,  59,  44,  29,  14,
  15,  30, 45,  60,  75,  90, 105, 120,
  135, 150, 165, 180, 195, 210, 225, 240,
  241, 226, 211, 196, 181, 166, 151, 136,
  121, 106,  91,  76,  61,  46,  31,  47,
  62,  77, 92, 107, 122, 137, 152, 167,
  182, 197, 212, 227, 242, 243, 228, 213,
  198, 183, 168, 153, 138, 123, 108, 93,
  78,  63,  79,  94, 109, 124, 139, 154,
  169, 184, 199, 214, 229, 244, 245, 230,
  215, 200, 185, 170, 155, 140, 125, 110,
  95, 111, 126, 141, 156, 171, 186, 201,
  216, 231, 246, 247, 232, 217, 202, 187,
  172, 157, 142, 127, 143, 158, 173, 188,
  203, 218, 233, 248, 249, 234, 219, 204,
  189, 174, 159, 175, 190, 205, 220, 235,
  250, 251, 236, 221, 206, 191, 207, 222,
  237, 252, 253, 238, 223, 239, 254, 255,
};

DECLARE_ALIGNED(16, const int, vp9_coef_bands_32x32[1024]) = {
  0, 1, 2, 3, 5, 4, 4, 5, 5, 3, 6, 3, 5, 4, 6, 6,
  6, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
  6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,

  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,

  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,

  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
  7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
};

DECLARE_ALIGNED(16, const int, vp9_default_zig_zag1d_32x32[1024]) = {
    0,    1,   32,   64,   33,    2,    3,   34,   65,   96,  128,   97,   66,   35,    4,    5,   36,   67,   98,  129,  160,  192,  161,  130,   99,   68,   37,    6,    7,   38,   69,  100,
  131,  162,  193,  224,  256,  225,  194,  163,  132,  101,   70,   39,    8,    9,   40,   71,  102,  133,  164,  195,  226,  257,  288,  320,  289,  258,  227,  196,  165,  134,  103,   72,
   41,   10,   11,   42,   73,  104,  135,  166,  197,  228,  259,  290,  321,  352,  384,  353,  322,  291,  260,  229,  198,  167,  136,  105,   74,   43,   12,   13,   44,   75,  106,  137,
  168,  199,  230,  261,  292,  323,  354,  385,  416,  448,  417,  386,  355,  324,  293,  262,  231,  200,  169,  138,  107,   76,   45,   14,   15,   46,   77,  108,  139,  170,  201,  232,
  263,  294,  325,  356,  387,  418,  449,  480,  512,  481,  450,  419,  388,  357,  326,  295,  264,  233,  202,  171,  140,  109,   78,   47,   16,   17,   48,   79,  110,  141,  172,  203,
  234,  265,  296,  327,  358,  389,  420,  451,  482,  513,  544,  576,  545,  514,  483,  452,  421,  390,  359,  328,  297,  266,  235,  204,  173,  142,  111,   80,   49,   18,   19,   50,
   81,  112,  143,  174,  205,  236,  267,  298,  329,  360,  391,  422,  453,  484,  515,  546,  577,  608,  640,  609,  578,  547,  516,  485,  454,  423,  392,  361,  330,  299,  268,  237,
  206,  175,  144,  113,   82,   51,   20,   21,   52,   83,  114,  145,  176,  207,  238,  269,  300,  331,  362,  393,  424,  455,  486,  517,  548,  579,  610,  641,  672,  704,  673,  642,
  611,  580,  549,  518,  487,  456,  425,  394,  363,  332,  301,  270,  239,  208,  177,  146,  115,   84,   53,   22,   23,   54,   85,  116,  147,  178,  209,  240,  271,  302,  333,  364,
  395,  426,  457,  488,  519,  550,  581,  612,  643,  674,  705,  736,  768,  737,  706,  675,  644,  613,  582,  551,  520,  489,  458,  427,  396,  365,  334,  303,  272,  241,  210,  179,
  148,  117,   86,   55,   24,   25,   56,   87,  118,  149,  180,  211,  242,  273,  304,  335,  366,  397,  428,  459,  490,  521,  552,  583,  614,  645,  676,  707,  738,  769,  800,  832,
  801,  770,  739,  708,  677,  646,  615,  584,  553,  522,  491,  460,  429,  398,  367,  336,  305,  274,  243,  212,  181,  150,  119,   88,   57,   26,   27,   58,   89,  120,  151,  182,
  213,  244,  275,  306,  337,  368,  399,  430,  461,  492,  523,  554,  585,  616,  647,  678,  709,  740,  771,  802,  833,  864,  896,  865,  834,  803,  772,  741,  710,  679,  648,  617,
  586,  555,  524,  493,  462,  431,  400,  369,  338,  307,  276,  245,  214,  183,  152,  121,   90,   59,   28,   29,   60,   91,  122,  153,  184,  215,  246,  277,  308,  339,  370,  401,
  432,  463,  494,  525,  556,  587,  618,  649,  680,  711,  742,  773,  804,  835,  866,  897,  928,  960,  929,  898,  867,  836,  805,  774,  743,  712,  681,  650,  619,  588,  557,  526,
  495,  464,  433,  402,  371,  340,  309,  278,  247,  216,  185,  154,  123,   92,   61,   30,   31,   62,   93,  124,  155,  186,  217,  248,  279,  310,  341,  372,  403,  434,  465,  496,
  527,  558,  589,  620,  651,  682,  713,  744,  775,  806,  837,  868,  899,  930,  961,  992,  993,  962,  931,  900,  869,  838,  807,  776,  745,  714,  683,  652,  621,  590,  559,  528,
  497,  466,  435,  404,  373,  342,  311,  280,  249,  218,  187,  156,  125,   94,   63,   95,  126,  157,  188,  219,  250,  281,  312,  343,  374,  405,  436,  467,  498,  529,  560,  591,
  622,  653,  684,  715,  746,  777,  808,  839,  870,  901,  932,  963,  994,  995,  964,  933,  902,  871,  840,  809,  778,  747,  716,  685,  654,  623,  592,  561,  530,  499,  468,  437,
  406,  375,  344,  313,  282,  251,  220,  189,  158,  127,  159,  190,  221,  252,  283,  314,  345,  376,  407,  438,  469,  500,  531,  562,  593,  624,  655,  686,  717,  748,  779,  810,
  841,  872,  903,  934,  965,  996,  997,  966,  935,  904,  873,  842,  811,  780,  749,  718,  687,  656,  625,  594,  563,  532,  501,  470,  439,  408,  377,  346,  315,  284,  253,  222,
  191,  223,  254,  285,  316,  347,  378,  409,  440,  471,  502,  533,  564,  595,  626,  657,  688,  719,  750,  781,  812,  843,  874,  905,  936,  967,  998,  999,  968,  937,  906,  875,
  844,  813,  782,  751,  720,  689,  658,  627,  596,  565,  534,  503,  472,  441,  410,  379,  348,  317,  286,  255,  287,  318,  349,  380,  411,  442,  473,  504,  535,  566,  597,  628,
  659,  690,  721,  752,  783,  814,  845,  876,  907,  938,  969, 1000, 1001,  970,  939,  908,  877,  846,  815,  784,  753,  722,  691,  660,  629,  598,  567,  536,  505,  474,  443,  412,
  381,  350,  319,  351,  382,  413,  444,  475,  506,  537,  568,  599,  630,  661,  692,  723,  754,  785,  816,  847,  878,  909,  940,  971, 1002, 1003,  972,  941,  910,  879,  848,  817,
  786,  755,  724,  693,  662,  631,  600,  569,  538,  507,  476,  445,  414,  383,  415,  446,  477,  508,  539,  570,  601,  632,  663,  694,  725,  756,  787,  818,  849,  880,  911,  942,
  973, 1004, 1005,  974,  943,  912,  881,  850,  819,  788,  757,  726,  695,  664,  633,  602,  571,  540,  509,  478,  447,  479,  510,  541,  572,  603,  634,  665,  696,  727,  758,  789,
  820,  851,  882,  913,  944,  975, 1006, 1007,  976,  945,  914,  883,  852,  821,  790,  759,  728,  697,  666,  635,  604,  573,  542,  511,  543,  574,  605,  636,  667,  698,  729,  760,
  791,  822,  853,  884,  915,  946,  977, 1008, 1009,  978,  947,  916,  885,  854,  823,  792,  761,  730,  699,  668,  637,  606,  575,  607,  638,  669,  700,  731,  762,  793,  824,  855,
  886,  917,  948,  979, 1010, 1011,  980,  949,  918,  887,  856,  825,  794,  763,  732,  701,  670,  639,  671,  702,  733,  764,  795,  826,  857,  888,  919,  950,  981, 1012, 1013,  982,
  951,  920,  889,  858,  827,  796,  765,  734,  703,  735,  766,  797,  828,  859,  890,  921,  952,  983, 1014, 1015,  984,  953,  922,  891,  860,  829,  798,  767,  799,  830,  861,  892,
  923,  954,  985, 1016, 1017,  986,  955,  924,  893,  862,  831,  863,  894,  925,  956,  987, 1018, 1019,  988,  957,  926,  895,  927,  958,  989, 1020, 1021,  990,  959,  991, 1022, 1023,
};

/* Array indices are identical to previously-existing CONTEXT_NODE indices */

const vp9_tree_index vp9_coef_tree[ 22] =     /* corresponding _CONTEXT_NODEs */
{
  -DCT_EOB_TOKEN, 2,                             /* 0 = EOB */
  -ZERO_TOKEN, 4,                               /* 1 = ZERO */
  -ONE_TOKEN, 6,                               /* 2 = ONE */
  8, 12,                                      /* 3 = LOW_VAL */
  -TWO_TOKEN, 10,                            /* 4 = TWO */
  -THREE_TOKEN, -FOUR_TOKEN,                /* 5 = THREE */
  14, 16,                                    /* 6 = HIGH_LOW */
  -DCT_VAL_CATEGORY1, -DCT_VAL_CATEGORY2,   /* 7 = CAT_ONE */
  18, 20,                                   /* 8 = CAT_THREEFOUR */
  -DCT_VAL_CATEGORY3, -DCT_VAL_CATEGORY4,  /* 9 = CAT_THREE */
  -DCT_VAL_CATEGORY5, -DCT_VAL_CATEGORY6   /* 10 = CAT_FIVE */
};

struct vp9_token_struct vp9_coef_encodings[MAX_ENTROPY_TOKENS];

/* Trees for extra bits.  Probabilities are constant and
   do not depend on previously encoded bits */

static const Prob Pcat1[] = { 159};
static const Prob Pcat2[] = { 165, 145};
static const Prob Pcat3[] = { 173, 148, 140};
static const Prob Pcat4[] = { 176, 155, 140, 135};
static const Prob Pcat5[] = { 180, 157, 141, 134, 130};
static const Prob Pcat6[] = {
  254, 254, 254, 252, 249, 243, 230, 196, 177, 153, 140, 133, 130, 129
};

static vp9_tree_index cat1[2], cat2[4], cat3[6], cat4[8], cat5[10], cat6[28];

static void init_bit_tree(vp9_tree_index *p, int n) {
  int i = 0;

  while (++i < n) {
    p[0] = p[1] = i << 1;
    p += 2;
  }

  p[0] = p[1] = 0;
}

static void init_bit_trees() {
  init_bit_tree(cat1, 1);
  init_bit_tree(cat2, 2);
  init_bit_tree(cat3, 3);
  init_bit_tree(cat4, 4);
  init_bit_tree(cat5, 5);
  init_bit_tree(cat6, 14);
}

vp9_extra_bit_struct vp9_extra_bits[12] = {
  { 0, 0, 0, 0},
  { 0, 0, 0, 1},
  { 0, 0, 0, 2},
  { 0, 0, 0, 3},
  { 0, 0, 0, 4},
  { cat1, Pcat1, 1, 5},
  { cat2, Pcat2, 2, 7},
  { cat3, Pcat3, 3, 11},
  { cat4, Pcat4, 4, 19},
  { cat5, Pcat5, 5, 35},
  { cat6, Pcat6, 14, 67},
  { 0, 0, 0, 0}
};

#include "vp9/common/vp9_default_coef_probs.h"

#if CONFIG_NEWCOEFCONTEXT
// Neighborhood 5-tuples for various scans and blocksizes,
// in {top, left, topleft, topright, bottomleft} order
// for each position in raster scan order.
// -1 indicates the neighbor does not exist.
DECLARE_ALIGNED(16, const int,
                vp9_default_zig_zag1d_neighbors[16 * MAX_NEIGHBORS]) = {
  -1, -1, -1, -1, -1,
  -1,  0, -1, -1, -1,
  -1,  1, -1, -1,  5,
  -1,  2, -1, -1, -1,
  -1, -1, -1,  1, -1,
  1,  4, -1, -1,  8,
  2,  5,  1,  3, -1,
  3,  6,  2, -1, 10,
  4, -1, -1, -1, -1,
  5,  8,  4,  6, -1,
  6,  9,  5, -1, 13,
  7, 10,  6, -1, -1,
  8, -1, -1,  9, -1,
  9, 12,  8, -1, -1,
  10, 13,  9, 11, -1,
  11, 14, 10, -1, -1,
};

DECLARE_ALIGNED(16, const int,
                vp9_col_scan_neighbors[16 * MAX_NEIGHBORS]) = {
  -1, -1, -1, -1, -1,
  -1, -1, -1, -1,  4,
  -1,  1, -1, -1,  5,
  -1,  2, -1, -1,  6,
  0, -1, -1, -1, -1,
  1,  4, -1, -1,  8,
  2,  5,  1, -1,  9,
  3,  6,  2, -1, 10,
  4, -1, -1, -1, -1,
  5,  8,  4, -1, 12,
  6,  9,  5, -1, 13,
  7, 10,  6, -1, 14,
  8, -1, -1, -1, -1,
  9, 12,  8, -1, -1,
  10, 13,  9, -1, -1,
  11, 14, 10, -1, -1,
};

DECLARE_ALIGNED(16, const int,
                vp9_row_scan_neighbors[16 * MAX_NEIGHBORS]) = {
  -1, -1, -1, -1, -1,
  -1,  0, -1, -1, -1,
  -1,  1, -1, -1, -1,
  -1,  2, -1, -1, -1,
  -1, -1, -1,  1, -1,
  1,  4, -1,  2, -1,
  2,  5,  1,  3, -1,
  3,  6,  2, -1, -1,
  4, -1, -1,  5, -1,
  5,  8,  4,  6, -1,
  6,  9,  5,  7, -1,
  7, 10,  6, -1, -1,
  8, -1, -1,  9, -1,
  9, 12,  8, 10, -1,
  10, 13,  9, 11, -1,
  11, 14, 10, -1, -1
};

DECLARE_ALIGNED(16, const int,
                vp9_default_zig_zag1d_8x8_neighbors[64 * MAX_NEIGHBORS]) = {
  -1, -1, -1, -1, -1,
  -1,  0, -1, -1, -1,
  -1,  1, -1, -1,  9,
  -1,  2, -1, -1, -1,
  -1,  3, -1, -1, 11,
  -1,  4, -1, -1, -1,
  -1,  5, -1, -1, 13,
  -1,  6, -1, -1, -1,
  -1, -1, -1,  1, -1,
  1,  8, -1, -1, 16,
  2,  9,  1,  3, -1,
  3, 10,  2, -1, 18,
  4, 11,  3,  5, -1,
  5, 12,  4, -1, 20,
  6, 13,  5,  7, -1,
  7, 14,  6, -1, 22,
  8, -1, -1, -1, -1,
  9, 16,  8, 10, -1,
  10, 17,  9, -1, 25,
  11, 18, 10, 12, -1,
  12, 19, 11, -1, 27,
  13, 20, 12, 14, -1,
  14, 21, 13, -1, 29,
  15, 22, 14, -1, -1,
  16, -1, -1, 17, -1,
  17, 24, 16, -1, 32,
  18, 25, 17, 19, -1,
  19, 26, 18, -1, 34,
  20, 27, 19, 21, -1,
  21, 28, 20, -1, 36,
  22, 29, 21, 23, -1,
  23, 30, 22, -1, 38,
  24, -1, -1, -1, -1,
  25, 32, 24, 26, -1,
  26, 33, 25, -1, 41,
  27, 34, 26, 28, -1,
  28, 35, 27, -1, 43,
  29, 36, 28, 30, -1,
  30, 37, 29, -1, 45,
  31, 38, 30, -1, -1,
  32, -1, -1, 33, -1,
  33, 40, 32, -1, 48,
  34, 41, 33, 35, -1,
  35, 42, 34, -1, 50,
  36, 43, 35, 37, -1,
  37, 44, 36, -1, 52,
  38, 45, 37, 39, -1,
  39, 46, 38, -1, 54,
  40, -1, -1, -1, -1,
  41, 48, 40, 42, -1,
  42, 49, 41, -1, 57,
  43, 50, 42, 44, -1,
  44, 51, 43, -1, 59,
  45, 52, 44, 46, -1,
  46, 53, 45, -1, 61,
  47, 54, 46, -1, -1,
  48, -1, -1, 49, -1,
  49, 56, 48, -1, -1,
  50, 57, 49, 51, -1,
  51, 58, 50, -1, -1,
  52, 59, 51, 53, -1,
  53, 60, 52, -1, -1,
  54, 61, 53, 55, -1,
  55, 62, 54, -1, -1,
};

DECLARE_ALIGNED(16, const int,
                vp9_default_zig_zag1d_16x16_neighbors[256 * MAX_NEIGHBORS]) = {
  -1,  -1,  -1,  -1,  -1,
  -1,   0,  -1,  -1,  -1,
  -1,   1,  -1,  -1,  17,
  -1,   2,  -1,  -1,  -1,
  -1,   3,  -1,  -1,  19,
  -1,   4,  -1,  -1,  -1,
  -1,   5,  -1,  -1,  21,
  -1,   6,  -1,  -1,  -1,
  -1,   7,  -1,  -1,  23,
  -1,   8,  -1,  -1,  -1,
  -1,   9,  -1,  -1,  25,
  -1,  10,  -1,  -1,  -1,
  -1,  11,  -1,  -1,  27,
  -1,  12,  -1,  -1,  -1,
  -1,  13,  -1,  -1,  29,
  -1,  14,  -1,  -1,  -1,
  -1,  -1,  -1,   1,  -1,
  1,  16,   -1,  -1,  32,
  2,  17,   1,   3,  -1,
  3,  18,   2,  -1,  34,
  4,  19,   3,   5,  -1,
  5,  20,   4,  -1,  36,
  6,  21,   5,   7,  -1,
  7,  22,   6,  -1,  38,
  8,  23,   7,   9,  -1,
  9,  24,   8,  -1,  40,
  10,  25,   9,  11,  -1,
  11,  26,  10,  -1,  42,
  12,  27,  11,  13,  -1,
  13,  28,  12,  -1,  44,
  14,  29,  13,  15,  -1,
  15,  30,  14,  -1,  46,
  16,  -1,  -1,  -1,  -1,
  17,  32,  16,  18,  -1,
  18,  33,  17,  -1,  49,
  19,  34,  18,  20,  -1,
  20,  35,  19,  -1,  51,
  21,  36,  20,  22,  -1,
  22,  37,  21,  -1,  53,
  23,  38,  22,  24,  -1,
  24,  39,  23,  -1,  55,
  25,  40,  24,  26,  -1,
  26,  41,  25,  -1,  57,
  27,  42,  26,  28,  -1,
  28,  43,  27,  -1,  59,
  29,  44,  28,  30,  -1,
  30,  45,  29,  -1,  61,
  31,  46,  30,  -1,  -1,
  32,  -1,  -1,  33,  -1,
  33,  48,  32,  -1,  64,
  34,  49,  33,  35,  -1,
  35,  50,  34,  -1,  66,
  36,  51,  35,  37,  -1,
  37,  52,  36,  -1,  68,
  38,  53,  37,  39,  -1,
  39,  54,  38,  -1,  70,
  40,  55,  39,  41,  -1,
  41,  56,  40,  -1,  72,
  42,  57,  41,  43,  -1,
  43,  58,  42,  -1,  74,
  44,  59,  43,  45,  -1,
  45,  60,  44,  -1,  76,
  46,  61,  45,  47,  -1,
  47,  62,  46,  -1,  78,
  48,  -1,  -1,  -1,  -1,
  49,  64,  48,  50,  -1,
  50,  65,  49,  -1,  81,
  51,  66,  50,  52,  -1,
  52,  67,  51,  -1,  83,
  53,  68,  52,  54,  -1,
  54,  69,  53,  -1,  85,
  55,  70,  54,  56,  -1,
  56,  71,  55,  -1,  87,
  57,  72,  56,  58,  -1,
  58,  73,  57,  -1,  89,
  59,  74,  58,  60,  -1,
  60,  75,  59,  -1,  91,
  61,  76,  60,  62,  -1,
  62,  77,  61,  -1,  93,
  63,  78,  62,  -1,  -1,
  64,  -1,  -1,  65,  -1,
  65,  80,  64,  -1,  96,
  66,  81,  65,  67,  -1,
  67,  82,  66,  -1,  98,
  68,  83,  67,  69,  -1,
  69,  84,  68,  -1, 100,
  70,  85,  69,  71,  -1,
  71,  86,  70,  -1, 102,
  72,  87,  71,  73,  -1,
  73,  88,  72,  -1, 104,
  74,  89,  73,  75,  -1,
  75,  90,  74,  -1, 106,
  76,  91,  75,  77,  -1,
  77,  92,  76,  -1, 108,
  78,  93,  77,  79,  -1,
  79,  94,  78,  -1, 110,
  80,  -1,  -1,  -1,  -1,
  81,  96,  80,  82,  -1,
  82,  97,  81,  -1, 113,
  83,  98,  82,  84,  -1,
  84,  99,  83,  -1, 115,
  85, 100,  84,  86,  -1,
  86, 101,  85,  -1, 117,
  87, 102,  86,  88,  -1,
  88, 103,  87,  -1, 119,
  89, 104,  88,  90,  -1,
  90, 105,  89,  -1, 121,
  91, 106,  90,  92,  -1,
  92, 107,  91,  -1, 123,
  93, 108,  92,  94,  -1,
  94, 109,  93,  -1, 125,
  95, 110,  94,  -1,  -1,
  96,  -1,  -1,  97,  -1,
  97, 112,  96,  -1, 128,
  98, 113,  97,  99,  -1,
  99, 114,  98,  -1, 130,
  100, 115,  99, 101,  -1,
  101, 116, 100,  -1, 132,
  102, 117, 101, 103,  -1,
  103, 118, 102,  -1, 134,
  104, 119, 103, 105,  -1,
  105, 120, 104,  -1, 136,
  106, 121, 105, 107,  -1,
  107, 122, 106,  -1, 138,
  108, 123, 107, 109,  -1,
  109, 124, 108,  -1, 140,
  110, 125, 109, 111,  -1,
  111, 126, 110,  -1, 142,
  112,  -1,  -1,  -1,  -1,
  113, 128, 112, 114,  -1,
  114, 129, 113,  -1, 145,
  115, 130, 114, 116,  -1,
  116, 131, 115,  -1, 147,
  117, 132, 116, 118,  -1,
  118, 133, 117,  -1, 149,
  119, 134, 118, 120,  -1,
  120, 135, 119,  -1, 151,
  121, 136, 120, 122,  -1,
  122, 137, 121,  -1, 153,
  123, 138, 122, 124,  -1,
  124, 139, 123,  -1, 155,
  125, 140, 124, 126,  -1,
  126, 141, 125,  -1, 157,
  127, 142, 126,  -1,  -1,
  128,  -1,  -1, 129,  -1,
  129, 144, 128,  -1, 160,
  130, 145, 129, 131,  -1,
  131, 146, 130,  -1, 162,
  132, 147, 131, 133,  -1,
  133, 148, 132,  -1, 164,
  134, 149, 133, 135,  -1,
  135, 150, 134,  -1, 166,
  136, 151, 135, 137,  -1,
  137, 152, 136,  -1, 168,
  138, 153, 137, 139,  -1,
  139, 154, 138,  -1, 170,
  140, 155, 139, 141,  -1,
  141, 156, 140,  -1, 172,
  142, 157, 141, 143,  -1,
  143, 158, 142,  -1, 174,
  144,  -1,  -1,  -1,  -1,
  145, 160, 144, 146,  -1,
  146, 161, 145,  -1, 177,
  147, 162, 146, 148,  -1,
  148, 163, 147,  -1, 179,
  149, 164, 148, 150,  -1,
  150, 165, 149,  -1, 181,
  151, 166, 150, 152,  -1,
  152, 167, 151,  -1, 183,
  153, 168, 152, 154,  -1,
  154, 169, 153,  -1, 185,
  155, 170, 154, 156,  -1,
  156, 171, 155,  -1, 187,
  157, 172, 156, 158,  -1,
  158, 173, 157,  -1, 189,
  159, 174, 158,  -1,  -1,
  160,  -1,  -1, 161,  -1,
  161, 176, 160,  -1, 192,
  162, 177, 161, 163,  -1,
  163, 178, 162,  -1, 194,
  164, 179, 163, 165,  -1,
  165, 180, 164,  -1, 196,
  166, 181, 165, 167,  -1,
  167, 182, 166,  -1, 198,
  168, 183, 167, 169,  -1,
  169, 184, 168,  -1, 200,
  170, 185, 169, 171,  -1,
  171, 186, 170,  -1, 202,
  172, 187, 171, 173,  -1,
  173, 188, 172,  -1, 204,
  174, 189, 173, 175,  -1,
  175, 190, 174,  -1, 206,
  176,  -1,  -1,  -1,  -1,
  177, 192, 176, 178,  -1,
  178, 193, 177,  -1, 209,
  179, 194, 178, 180,  -1,
  180, 195, 179,  -1, 211,
  181, 196, 180, 182,  -1,
  182, 197, 181,  -1, 213,
  183, 198, 182, 184,  -1,
  184, 199, 183,  -1, 215,
  185, 200, 184, 186,  -1,
  186, 201, 185,  -1, 217,
  187, 202, 186, 188,  -1,
  188, 203, 187,  -1, 219,
  189, 204, 188, 190,  -1,
  190, 205, 189,  -1, 221,
  191, 206, 190,  -1,  -1,
  192,  -1,  -1, 193,  -1,
  193, 208, 192,  -1, 224,
  194, 209, 193, 195,  -1,
  195, 210, 194,  -1, 226,
  196, 211, 195, 197,  -1,
  197, 212, 196,  -1, 228,
  198, 213, 197, 199,  -1,
  199, 214, 198,  -1, 230,
  200, 215, 199, 201,  -1,
  201, 216, 200,  -1, 232,
  202, 217, 201, 203,  -1,
  203, 218, 202,  -1, 234,
  204, 219, 203, 205,  -1,
  205, 220, 204,  -1, 236,
  206, 221, 205, 207,  -1,
  207, 222, 206,  -1, 238,
  208,  -1,  -1,  -1,  -1,
  209, 224, 208, 210,  -1,
  210, 225, 209,  -1, 241,
  211, 226, 210, 212,  -1,
  212, 227, 211,  -1, 243,
  213, 228, 212, 214,  -1,
  214, 229, 213,  -1, 245,
  215, 230, 214, 216,  -1,
  216, 231, 215,  -1, 247,
  217, 232, 216, 218,  -1,
  218, 233, 217,  -1, 249,
  219, 234, 218, 220,  -1,
  220, 235, 219,  -1, 251,
  221, 236, 220, 222,  -1,
  222, 237, 221,  -1, 253,
  223, 238, 222,  -1,  -1,
  224,  -1,  -1, 225,  -1,
  225, 240, 224,  -1,  -1,
  226, 241, 225, 227,  -1,
  227, 242, 226,  -1,  -1,
  228, 243, 227, 229,  -1,
  229, 244, 228,  -1,  -1,
  230, 245, 229, 231,  -1,
  231, 246, 230,  -1,  -1,
  232, 247, 231, 233,  -1,
  233, 248, 232,  -1,  -1,
  234, 249, 233, 235,  -1,
  235, 250, 234,  -1,  -1,
  236, 251, 235, 237,  -1,
  237, 252, 236,  -1,  -1,
  238, 253, 237, 239,  -1,
  239, 254, 238,  -1,  -1,
};

#if CONFIG_TX32X32
DECLARE_ALIGNED(16, const int,
                vp9_default_zig_zag1d_32x32_neighbors[1024 * MAX_NEIGHBORS]) = {
  -1,   -1,   -1,   -1,   -1,
  -1,    0,   -1,   -1,   -1,
  -1,    1,   -1,   -1,   33,
  -1,    2,   -1,   -1,   -1,
  -1,    3,   -1,   -1,   35,
  -1,    4,   -1,   -1,   -1,
  -1,    5,   -1,   -1,   37,
  -1,    6,   -1,   -1,   -1,
  -1,    7,   -1,   -1,   39,
  -1,    8,   -1,   -1,   -1,
  -1,    9,   -1,   -1,   41,
  -1,   10,   -1,   -1,   -1,
  -1,   11,   -1,   -1,   43,
  -1,   12,   -1,   -1,   -1,
  -1,   13,   -1,   -1,   45,
  -1,   14,   -1,   -1,   -1,
  -1,   15,   -1,   -1,   47,
  -1,   16,   -1,   -1,   -1,
  -1,   17,   -1,   -1,   49,
  -1,   18,   -1,   -1,   -1,
  -1,   19,   -1,   -1,   51,
  -1,   20,   -1,   -1,   -1,
  -1,   21,   -1,   -1,   53,
  -1,   22,   -1,   -1,   -1,
  -1,   23,   -1,   -1,   55,
  -1,   24,   -1,   -1,   -1,
  -1,   25,   -1,   -1,   57,
  -1,   26,   -1,   -1,   -1,
  -1,   27,   -1,   -1,   59,
  -1,   28,   -1,   -1,   -1,
  -1,   29,   -1,   -1,   61,
  -1,   30,   -1,   -1,   -1,
  -1,   -1,   -1,    1,   -1,
  1,   32,   -1,   -1,   64,
  2,   33,    1,    3,   -1,
  3,   34,    2,   -1,   66,
  4,   35,    3,    5,   -1,
  5,   36,    4,   -1,   68,
  6,   37,    5,    7,   -1,
  7,   38,    6,   -1,   70,
  8,   39,    7,    9,   -1,
  9,   40,    8,   -1,   72,
  10,   41,    9,   11,   -1,
  11,   42,   10,   -1,   74,
  12,   43,   11,   13,   -1,
  13,   44,   12,   -1,   76,
  14,   45,   13,   15,   -1,
  15,   46,   14,   -1,   78,
  16,   47,   15,   17,   -1,
  17,   48,   16,   -1,   80,
  18,   49,   17,   19,   -1,
  19,   50,   18,   -1,   82,
  20,   51,   19,   21,   -1,
  21,   52,   20,   -1,   84,
  22,   53,   21,   23,   -1,
  23,   54,   22,   -1,   86,
  24,   55,   23,   25,   -1,
  25,   56,   24,   -1,   88,
  26,   57,   25,   27,   -1,
  27,   58,   26,   -1,   90,
  28,   59,   27,   29,   -1,
  29,   60,   28,   -1,   92,
  30,   61,   29,   31,   -1,
  31,   62,   30,   -1,   94,
  32,   -1,   -1,   -1,   -1,
  33,   64,   32,   34,   -1,
  34,   65,   33,   -1,   97,
  35,   66,   34,   36,   -1,
  36,   67,   35,   -1,   99,
  37,   68,   36,   38,   -1,
  38,   69,   37,   -1,  101,
  39,   70,   38,   40,   -1,
  40,   71,   39,   -1,  103,
  41,   72,   40,   42,   -1,
  42,   73,   41,   -1,  105,
  43,   74,   42,   44,   -1,
  44,   75,   43,   -1,  107,
  45,   76,   44,   46,   -1,
  46,   77,   45,   -1,  109,
  47,   78,   46,   48,   -1,
  48,   79,   47,   -1,  111,
  49,   80,   48,   50,   -1,
  50,   81,   49,   -1,  113,
  51,   82,   50,   52,   -1,
  52,   83,   51,   -1,  115,
  53,   84,   52,   54,   -1,
  54,   85,   53,   -1,  117,
  55,   86,   54,   56,   -1,
  56,   87,   55,   -1,  119,
  57,   88,   56,   58,   -1,
  58,   89,   57,   -1,  121,
  59,   90,   58,   60,   -1,
  60,   91,   59,   -1,  123,
  61,   92,   60,   62,   -1,
  62,   93,   61,   -1,  125,
  63,   94,   62,   -1,   -1,
  64,   -1,   -1,   65,   -1,
  65,   96,   64,   -1,  128,
  66,   97,   65,   67,   -1,
  67,   98,   66,   -1,  130,
  68,   99,   67,   69,   -1,
  69,  100,   68,   -1,  132,
  70,  101,   69,   71,   -1,
  71,  102,   70,   -1,  134,
  72,  103,   71,   73,   -1,
  73,  104,   72,   -1,  136,
  74,  105,   73,   75,   -1,
  75,  106,   74,   -1,  138,
  76,  107,   75,   77,   -1,
  77,  108,   76,   -1,  140,
  78,  109,   77,   79,   -1,
  79,  110,   78,   -1,  142,
  80,  111,   79,   81,   -1,
  81,  112,   80,   -1,  144,
  82,  113,   81,   83,   -1,
  83,  114,   82,   -1,  146,
  84,  115,   83,   85,   -1,
  85,  116,   84,   -1,  148,
  86,  117,   85,   87,   -1,
  87,  118,   86,   -1,  150,
  88,  119,   87,   89,   -1,
  89,  120,   88,   -1,  152,
  90,  121,   89,   91,   -1,
  91,  122,   90,   -1,  154,
  92,  123,   91,   93,   -1,
  93,  124,   92,   -1,  156,
  94,  125,   93,   95,   -1,
  95,  126,   94,   -1,  158,
  96,   -1,   -1,   -1,   -1,
  97,  128,   96,   98,   -1,
  98,  129,   97,   -1,  161,
  99,  130,   98,  100,   -1,
  100,  131,   99,   -1,  163,
  101,  132,  100,  102,   -1,
  102,  133,  101,   -1,  165,
  103,  134,  102,  104,   -1,
  104,  135,  103,   -1,  167,
  105,  136,  104,  106,   -1,
  106,  137,  105,   -1,  169,
  107,  138,  106,  108,   -1,
  108,  139,  107,   -1,  171,
  109,  140,  108,  110,   -1,
  110,  141,  109,   -1,  173,
  111,  142,  110,  112,   -1,
  112,  143,  111,   -1,  175,
  113,  144,  112,  114,   -1,
  114,  145,  113,   -1,  177,
  115,  146,  114,  116,   -1,
  116,  147,  115,   -1,  179,
  117,  148,  116,  118,   -1,
  118,  149,  117,   -1,  181,
  119,  150,  118,  120,   -1,
  120,  151,  119,   -1,  183,
  121,  152,  120,  122,   -1,
  122,  153,  121,   -1,  185,
  123,  154,  122,  124,   -1,
  124,  155,  123,   -1,  187,
  125,  156,  124,  126,   -1,
  126,  157,  125,   -1,  189,
  127,  158,  126,   -1,   -1,
  128,   -1,   -1,  129,   -1,
  129,  160,  128,   -1,  192,
  130,  161,  129,  131,   -1,
  131,  162,  130,   -1,  194,
  132,  163,  131,  133,   -1,
  133,  164,  132,   -1,  196,
  134,  165,  133,  135,   -1,
  135,  166,  134,   -1,  198,
  136,  167,  135,  137,   -1,
  137,  168,  136,   -1,  200,
  138,  169,  137,  139,   -1,
  139,  170,  138,   -1,  202,
  140,  171,  139,  141,   -1,
  141,  172,  140,   -1,  204,
  142,  173,  141,  143,   -1,
  143,  174,  142,   -1,  206,
  144,  175,  143,  145,   -1,
  145,  176,  144,   -1,  208,
  146,  177,  145,  147,   -1,
  147,  178,  146,   -1,  210,
  148,  179,  147,  149,   -1,
  149,  180,  148,   -1,  212,
  150,  181,  149,  151,   -1,
  151,  182,  150,   -1,  214,
  152,  183,  151,  153,   -1,
  153,  184,  152,   -1,  216,
  154,  185,  153,  155,   -1,
  155,  186,  154,   -1,  218,
  156,  187,  155,  157,   -1,
  157,  188,  156,   -1,  220,
  158,  189,  157,  159,   -1,
  159,  190,  158,   -1,  222,
  160,   -1,   -1,   -1,   -1,
  161,  192,  160,  162,   -1,
  162,  193,  161,   -1,  225,
  163,  194,  162,  164,   -1,
  164,  195,  163,   -1,  227,
  165,  196,  164,  166,   -1,
  166,  197,  165,   -1,  229,
  167,  198,  166,  168,   -1,
  168,  199,  167,   -1,  231,
  169,  200,  168,  170,   -1,
  170,  201,  169,   -1,  233,
  171,  202,  170,  172,   -1,
  172,  203,  171,   -1,  235,
  173,  204,  172,  174,   -1,
  174,  205,  173,   -1,  237,
  175,  206,  174,  176,   -1,
  176,  207,  175,   -1,  239,
  177,  208,  176,  178,   -1,
  178,  209,  177,   -1,  241,
  179,  210,  178,  180,   -1,
  180,  211,  179,   -1,  243,
  181,  212,  180,  182,   -1,
  182,  213,  181,   -1,  245,
  183,  214,  182,  184,   -1,
  184,  215,  183,   -1,  247,
  185,  216,  184,  186,   -1,
  186,  217,  185,   -1,  249,
  187,  218,  186,  188,   -1,
  188,  219,  187,   -1,  251,
  189,  220,  188,  190,   -1,
  190,  221,  189,   -1,  253,
  191,  222,  190,   -1,   -1,
  192,   -1,   -1,  193,   -1,
  193,  224,  192,   -1,  256,
  194,  225,  193,  195,   -1,
  195,  226,  194,   -1,  258,
  196,  227,  195,  197,   -1,
  197,  228,  196,   -1,  260,
  198,  229,  197,  199,   -1,
  199,  230,  198,   -1,  262,
  200,  231,  199,  201,   -1,
  201,  232,  200,   -1,  264,
  202,  233,  201,  203,   -1,
  203,  234,  202,   -1,  266,
  204,  235,  203,  205,   -1,
  205,  236,  204,   -1,  268,
  206,  237,  205,  207,   -1,
  207,  238,  206,   -1,  270,
  208,  239,  207,  209,   -1,
  209,  240,  208,   -1,  272,
  210,  241,  209,  211,   -1,
  211,  242,  210,   -1,  274,
  212,  243,  211,  213,   -1,
  213,  244,  212,   -1,  276,
  214,  245,  213,  215,   -1,
  215,  246,  214,   -1,  278,
  216,  247,  215,  217,   -1,
  217,  248,  216,   -1,  280,
  218,  249,  217,  219,   -1,
  219,  250,  218,   -1,  282,
  220,  251,  219,  221,   -1,
  221,  252,  220,   -1,  284,
  222,  253,  221,  223,   -1,
  223,  254,  222,   -1,  286,
  224,   -1,   -1,   -1,   -1,
  225,  256,  224,  226,   -1,
  226,  257,  225,   -1,  289,
  227,  258,  226,  228,   -1,
  228,  259,  227,   -1,  291,
  229,  260,  228,  230,   -1,
  230,  261,  229,   -1,  293,
  231,  262,  230,  232,   -1,
  232,  263,  231,   -1,  295,
  233,  264,  232,  234,   -1,
  234,  265,  233,   -1,  297,
  235,  266,  234,  236,   -1,
  236,  267,  235,   -1,  299,
  237,  268,  236,  238,   -1,
  238,  269,  237,   -1,  301,
  239,  270,  238,  240,   -1,
  240,  271,  239,   -1,  303,
  241,  272,  240,  242,   -1,
  242,  273,  241,   -1,  305,
  243,  274,  242,  244,   -1,
  244,  275,  243,   -1,  307,
  245,  276,  244,  246,   -1,
  246,  277,  245,   -1,  309,
  247,  278,  246,  248,   -1,
  248,  279,  247,   -1,  311,
  249,  280,  248,  250,   -1,
  250,  281,  249,   -1,  313,
  251,  282,  250,  252,   -1,
  252,  283,  251,   -1,  315,
  253,  284,  252,  254,   -1,
  254,  285,  253,   -1,  317,
  255,  286,  254,   -1,   -1,
  256,   -1,   -1,  257,   -1,
  257,  288,  256,   -1,  320,
  258,  289,  257,  259,   -1,
  259,  290,  258,   -1,  322,
  260,  291,  259,  261,   -1,
  261,  292,  260,   -1,  324,
  262,  293,  261,  263,   -1,
  263,  294,  262,   -1,  326,
  264,  295,  263,  265,   -1,
  265,  296,  264,   -1,  328,
  266,  297,  265,  267,   -1,
  267,  298,  266,   -1,  330,
  268,  299,  267,  269,   -1,
  269,  300,  268,   -1,  332,
  270,  301,  269,  271,   -1,
  271,  302,  270,   -1,  334,
  272,  303,  271,  273,   -1,
  273,  304,  272,   -1,  336,
  274,  305,  273,  275,   -1,
  275,  306,  274,   -1,  338,
  276,  307,  275,  277,   -1,
  277,  308,  276,   -1,  340,
  278,  309,  277,  279,   -1,
  279,  310,  278,   -1,  342,
  280,  311,  279,  281,   -1,
  281,  312,  280,   -1,  344,
  282,  313,  281,  283,   -1,
  283,  314,  282,   -1,  346,
  284,  315,  283,  285,   -1,
  285,  316,  284,   -1,  348,
  286,  317,  285,  287,   -1,
  287,  318,  286,   -1,  350,
  288,   -1,   -1,   -1,   -1,
  289,  320,  288,  290,   -1,
  290,  321,  289,   -1,  353,
  291,  322,  290,  292,   -1,
  292,  323,  291,   -1,  355,
  293,  324,  292,  294,   -1,
  294,  325,  293,   -1,  357,
  295,  326,  294,  296,   -1,
  296,  327,  295,   -1,  359,
  297,  328,  296,  298,   -1,
  298,  329,  297,   -1,  361,
  299,  330,  298,  300,   -1,
  300,  331,  299,   -1,  363,
  301,  332,  300,  302,   -1,
  302,  333,  301,   -1,  365,
  303,  334,  302,  304,   -1,
  304,  335,  303,   -1,  367,
  305,  336,  304,  306,   -1,
  306,  337,  305,   -1,  369,
  307,  338,  306,  308,   -1,
  308,  339,  307,   -1,  371,
  309,  340,  308,  310,   -1,
  310,  341,  309,   -1,  373,
  311,  342,  310,  312,   -1,
  312,  343,  311,   -1,  375,
  313,  344,  312,  314,   -1,
  314,  345,  313,   -1,  377,
  315,  346,  314,  316,   -1,
  316,  347,  315,   -1,  379,
  317,  348,  316,  318,   -1,
  318,  349,  317,   -1,  381,
  319,  350,  318,   -1,   -1,
  320,   -1,   -1,  321,   -1,
  321,  352,  320,   -1,  384,
  322,  353,  321,  323,   -1,
  323,  354,  322,   -1,  386,
  324,  355,  323,  325,   -1,
  325,  356,  324,   -1,  388,
  326,  357,  325,  327,   -1,
  327,  358,  326,   -1,  390,
  328,  359,  327,  329,   -1,
  329,  360,  328,   -1,  392,
  330,  361,  329,  331,   -1,
  331,  362,  330,   -1,  394,
  332,  363,  331,  333,   -1,
  333,  364,  332,   -1,  396,
  334,  365,  333,  335,   -1,
  335,  366,  334,   -1,  398,
  336,  367,  335,  337,   -1,
  337,  368,  336,   -1,  400,
  338,  369,  337,  339,   -1,
  339,  370,  338,   -1,  402,
  340,  371,  339,  341,   -1,
  341,  372,  340,   -1,  404,
  342,  373,  341,  343,   -1,
  343,  374,  342,   -1,  406,
  344,  375,  343,  345,   -1,
  345,  376,  344,   -1,  408,
  346,  377,  345,  347,   -1,
  347,  378,  346,   -1,  410,
  348,  379,  347,  349,   -1,
  349,  380,  348,   -1,  412,
  350,  381,  349,  351,   -1,
  351,  382,  350,   -1,  414,
  352,   -1,   -1,   -1,   -1,
  353,  384,  352,  354,   -1,
  354,  385,  353,   -1,  417,
  355,  386,  354,  356,   -1,
  356,  387,  355,   -1,  419,
  357,  388,  356,  358,   -1,
  358,  389,  357,   -1,  421,
  359,  390,  358,  360,   -1,
  360,  391,  359,   -1,  423,
  361,  392,  360,  362,   -1,
  362,  393,  361,   -1,  425,
  363,  394,  362,  364,   -1,
  364,  395,  363,   -1,  427,
  365,  396,  364,  366,   -1,
  366,  397,  365,   -1,  429,
  367,  398,  366,  368,   -1,
  368,  399,  367,   -1,  431,
  369,  400,  368,  370,   -1,
  370,  401,  369,   -1,  433,
  371,  402,  370,  372,   -1,
  372,  403,  371,   -1,  435,
  373,  404,  372,  374,   -1,
  374,  405,  373,   -1,  437,
  375,  406,  374,  376,   -1,
  376,  407,  375,   -1,  439,
  377,  408,  376,  378,   -1,
  378,  409,  377,   -1,  441,
  379,  410,  378,  380,   -1,
  380,  411,  379,   -1,  443,
  381,  412,  380,  382,   -1,
  382,  413,  381,   -1,  445,
  383,  414,  382,   -1,   -1,
  384,   -1,   -1,  385,   -1,
  385,  416,  384,   -1,  448,
  386,  417,  385,  387,   -1,
  387,  418,  386,   -1,  450,
  388,  419,  387,  389,   -1,
  389,  420,  388,   -1,  452,
  390,  421,  389,  391,   -1,
  391,  422,  390,   -1,  454,
  392,  423,  391,  393,   -1,
  393,  424,  392,   -1,  456,
  394,  425,  393,  395,   -1,
  395,  426,  394,   -1,  458,
  396,  427,  395,  397,   -1,
  397,  428,  396,   -1,  460,
  398,  429,  397,  399,   -1,
  399,  430,  398,   -1,  462,
  400,  431,  399,  401,   -1,
  401,  432,  400,   -1,  464,
  402,  433,  401,  403,   -1,
  403,  434,  402,   -1,  466,
  404,  435,  403,  405,   -1,
  405,  436,  404,   -1,  468,
  406,  437,  405,  407,   -1,
  407,  438,  406,   -1,  470,
  408,  439,  407,  409,   -1,
  409,  440,  408,   -1,  472,
  410,  441,  409,  411,   -1,
  411,  442,  410,   -1,  474,
  412,  443,  411,  413,   -1,
  413,  444,  412,   -1,  476,
  414,  445,  413,  415,   -1,
  415,  446,  414,   -1,  478,
  416,   -1,   -1,   -1,   -1,
  417,  448,  416,  418,   -1,
  418,  449,  417,   -1,  481,
  419,  450,  418,  420,   -1,
  420,  451,  419,   -1,  483,
  421,  452,  420,  422,   -1,
  422,  453,  421,   -1,  485,
  423,  454,  422,  424,   -1,
  424,  455,  423,   -1,  487,
  425,  456,  424,  426,   -1,
  426,  457,  425,   -1,  489,
  427,  458,  426,  428,   -1,
  428,  459,  427,   -1,  491,
  429,  460,  428,  430,   -1,
  430,  461,  429,   -1,  493,
  431,  462,  430,  432,   -1,
  432,  463,  431,   -1,  495,
  433,  464,  432,  434,   -1,
  434,  465,  433,   -1,  497,
  435,  466,  434,  436,   -1,
  436,  467,  435,   -1,  499,
  437,  468,  436,  438,   -1,
  438,  469,  437,   -1,  501,
  439,  470,  438,  440,   -1,
  440,  471,  439,   -1,  503,
  441,  472,  440,  442,   -1,
  442,  473,  441,   -1,  505,
  443,  474,  442,  444,   -1,
  444,  475,  443,   -1,  507,
  445,  476,  444,  446,   -1,
  446,  477,  445,   -1,  509,
  447,  478,  446,   -1,   -1,
  448,   -1,   -1,  449,   -1,
  449,  480,  448,   -1,  512,
  450,  481,  449,  451,   -1,
  451,  482,  450,   -1,  514,
  452,  483,  451,  453,   -1,
  453,  484,  452,   -1,  516,
  454,  485,  453,  455,   -1,
  455,  486,  454,   -1,  518,
  456,  487,  455,  457,   -1,
  457,  488,  456,   -1,  520,
  458,  489,  457,  459,   -1,
  459,  490,  458,   -1,  522,
  460,  491,  459,  461,   -1,
  461,  492,  460,   -1,  524,
  462,  493,  461,  463,   -1,
  463,  494,  462,   -1,  526,
  464,  495,  463,  465,   -1,
  465,  496,  464,   -1,  528,
  466,  497,  465,  467,   -1,
  467,  498,  466,   -1,  530,
  468,  499,  467,  469,   -1,
  469,  500,  468,   -1,  532,
  470,  501,  469,  471,   -1,
  471,  502,  470,   -1,  534,
  472,  503,  471,  473,   -1,
  473,  504,  472,   -1,  536,
  474,  505,  473,  475,   -1,
  475,  506,  474,   -1,  538,
  476,  507,  475,  477,   -1,
  477,  508,  476,   -1,  540,
  478,  509,  477,  479,   -1,
  479,  510,  478,   -1,  542,
  480,   -1,   -1,   -1,   -1,
  481,  512,  480,  482,   -1,
  482,  513,  481,   -1,  545,
  483,  514,  482,  484,   -1,
  484,  515,  483,   -1,  547,
  485,  516,  484,  486,   -1,
  486,  517,  485,   -1,  549,
  487,  518,  486,  488,   -1,
  488,  519,  487,   -1,  551,
  489,  520,  488,  490,   -1,
  490,  521,  489,   -1,  553,
  491,  522,  490,  492,   -1,
  492,  523,  491,   -1,  555,
  493,  524,  492,  494,   -1,
  494,  525,  493,   -1,  557,
  495,  526,  494,  496,   -1,
  496,  527,  495,   -1,  559,
  497,  528,  496,  498,   -1,
  498,  529,  497,   -1,  561,
  499,  530,  498,  500,   -1,
  500,  531,  499,   -1,  563,
  501,  532,  500,  502,   -1,
  502,  533,  501,   -1,  565,
  503,  534,  502,  504,   -1,
  504,  535,  503,   -1,  567,
  505,  536,  504,  506,   -1,
  506,  537,  505,   -1,  569,
  507,  538,  506,  508,   -1,
  508,  539,  507,   -1,  571,
  509,  540,  508,  510,   -1,
  510,  541,  509,   -1,  573,
  511,  542,  510,   -1,   -1,
  512,   -1,   -1,  513,   -1,
  513,  544,  512,   -1,  576,
  514,  545,  513,  515,   -1,
  515,  546,  514,   -1,  578,
  516,  547,  515,  517,   -1,
  517,  548,  516,   -1,  580,
  518,  549,  517,  519,   -1,
  519,  550,  518,   -1,  582,
  520,  551,  519,  521,   -1,
  521,  552,  520,   -1,  584,
  522,  553,  521,  523,   -1,
  523,  554,  522,   -1,  586,
  524,  555,  523,  525,   -1,
  525,  556,  524,   -1,  588,
  526,  557,  525,  527,   -1,
  527,  558,  526,   -1,  590,
  528,  559,  527,  529,   -1,
  529,  560,  528,   -1,  592,
  530,  561,  529,  531,   -1,
  531,  562,  530,   -1,  594,
  532,  563,  531,  533,   -1,
  533,  564,  532,   -1,  596,
  534,  565,  533,  535,   -1,
  535,  566,  534,   -1,  598,
  536,  567,  535,  537,   -1,
  537,  568,  536,   -1,  600,
  538,  569,  537,  539,   -1,
  539,  570,  538,   -1,  602,
  540,  571,  539,  541,   -1,
  541,  572,  540,   -1,  604,
  542,  573,  541,  543,   -1,
  543,  574,  542,   -1,  606,
  544,   -1,   -1,   -1,   -1,
  545,  576,  544,  546,   -1,
  546,  577,  545,   -1,  609,
  547,  578,  546,  548,   -1,
  548,  579,  547,   -1,  611,
  549,  580,  548,  550,   -1,
  550,  581,  549,   -1,  613,
  551,  582,  550,  552,   -1,
  552,  583,  551,   -1,  615,
  553,  584,  552,  554,   -1,
  554,  585,  553,   -1,  617,
  555,  586,  554,  556,   -1,
  556,  587,  555,   -1,  619,
  557,  588,  556,  558,   -1,
  558,  589,  557,   -1,  621,
  559,  590,  558,  560,   -1,
  560,  591,  559,   -1,  623,
  561,  592,  560,  562,   -1,
  562,  593,  561,   -1,  625,
  563,  594,  562,  564,   -1,
  564,  595,  563,   -1,  627,
  565,  596,  564,  566,   -1,
  566,  597,  565,   -1,  629,
  567,  598,  566,  568,   -1,
  568,  599,  567,   -1,  631,
  569,  600,  568,  570,   -1,
  570,  601,  569,   -1,  633,
  571,  602,  570,  572,   -1,
  572,  603,  571,   -1,  635,
  573,  604,  572,  574,   -1,
  574,  605,  573,   -1,  637,
  575,  606,  574,   -1,   -1,
  576,   -1,   -1,  577,   -1,
  577,  608,  576,   -1,  640,
  578,  609,  577,  579,   -1,
  579,  610,  578,   -1,  642,
  580,  611,  579,  581,   -1,
  581,  612,  580,   -1,  644,
  582,  613,  581,  583,   -1,
  583,  614,  582,   -1,  646,
  584,  615,  583,  585,   -1,
  585,  616,  584,   -1,  648,
  586,  617,  585,  587,   -1,
  587,  618,  586,   -1,  650,
  588,  619,  587,  589,   -1,
  589,  620,  588,   -1,  652,
  590,  621,  589,  591,   -1,
  591,  622,  590,   -1,  654,
  592,  623,  591,  593,   -1,
  593,  624,  592,   -1,  656,
  594,  625,  593,  595,   -1,
  595,  626,  594,   -1,  658,
  596,  627,  595,  597,   -1,
  597,  628,  596,   -1,  660,
  598,  629,  597,  599,   -1,
  599,  630,  598,   -1,  662,
  600,  631,  599,  601,   -1,
  601,  632,  600,   -1,  664,
  602,  633,  601,  603,   -1,
  603,  634,  602,   -1,  666,
  604,  635,  603,  605,   -1,
  605,  636,  604,   -1,  668,
  606,  637,  605,  607,   -1,
  607,  638,  606,   -1,  670,
  608,   -1,   -1,   -1,   -1,
  609,  640,  608,  610,   -1,
  610,  641,  609,   -1,  673,
  611,  642,  610,  612,   -1,
  612,  643,  611,   -1,  675,
  613,  644,  612,  614,   -1,
  614,  645,  613,   -1,  677,
  615,  646,  614,  616,   -1,
  616,  647,  615,   -1,  679,
  617,  648,  616,  618,   -1,
  618,  649,  617,   -1,  681,
  619,  650,  618,  620,   -1,
  620,  651,  619,   -1,  683,
  621,  652,  620,  622,   -1,
  622,  653,  621,   -1,  685,
  623,  654,  622,  624,   -1,
  624,  655,  623,   -1,  687,
  625,  656,  624,  626,   -1,
  626,  657,  625,   -1,  689,
  627,  658,  626,  628,   -1,
  628,  659,  627,   -1,  691,
  629,  660,  628,  630,   -1,
  630,  661,  629,   -1,  693,
  631,  662,  630,  632,   -1,
  632,  663,  631,   -1,  695,
  633,  664,  632,  634,   -1,
  634,  665,  633,   -1,  697,
  635,  666,  634,  636,   -1,
  636,  667,  635,   -1,  699,
  637,  668,  636,  638,   -1,
  638,  669,  637,   -1,  701,
  639,  670,  638,   -1,   -1,
  640,   -1,   -1,  641,   -1,
  641,  672,  640,   -1,  704,
  642,  673,  641,  643,   -1,
  643,  674,  642,   -1,  706,
  644,  675,  643,  645,   -1,
  645,  676,  644,   -1,  708,
  646,  677,  645,  647,   -1,
  647,  678,  646,   -1,  710,
  648,  679,  647,  649,   -1,
  649,  680,  648,   -1,  712,
  650,  681,  649,  651,   -1,
  651,  682,  650,   -1,  714,
  652,  683,  651,  653,   -1,
  653,  684,  652,   -1,  716,
  654,  685,  653,  655,   -1,
  655,  686,  654,   -1,  718,
  656,  687,  655,  657,   -1,
  657,  688,  656,   -1,  720,
  658,  689,  657,  659,   -1,
  659,  690,  658,   -1,  722,
  660,  691,  659,  661,   -1,
  661,  692,  660,   -1,  724,
  662,  693,  661,  663,   -1,
  663,  694,  662,   -1,  726,
  664,  695,  663,  665,   -1,
  665,  696,  664,   -1,  728,
  666,  697,  665,  667,   -1,
  667,  698,  666,   -1,  730,
  668,  699,  667,  669,   -1,
  669,  700,  668,   -1,  732,
  670,  701,  669,  671,   -1,
  671,  702,  670,   -1,  734,
  672,   -1,   -1,   -1,   -1,
  673,  704,  672,  674,   -1,
  674,  705,  673,   -1,  737,
  675,  706,  674,  676,   -1,
  676,  707,  675,   -1,  739,
  677,  708,  676,  678,   -1,
  678,  709,  677,   -1,  741,
  679,  710,  678,  680,   -1,
  680,  711,  679,   -1,  743,
  681,  712,  680,  682,   -1,
  682,  713,  681,   -1,  745,
  683,  714,  682,  684,   -1,
  684,  715,  683,   -1,  747,
  685,  716,  684,  686,   -1,
  686,  717,  685,   -1,  749,
  687,  718,  686,  688,   -1,
  688,  719,  687,   -1,  751,
  689,  720,  688,  690,   -1,
  690,  721,  689,   -1,  753,
  691,  722,  690,  692,   -1,
  692,  723,  691,   -1,  755,
  693,  724,  692,  694,   -1,
  694,  725,  693,   -1,  757,
  695,  726,  694,  696,   -1,
  696,  727,  695,   -1,  759,
  697,  728,  696,  698,   -1,
  698,  729,  697,   -1,  761,
  699,  730,  698,  700,   -1,
  700,  731,  699,   -1,  763,
  701,  732,  700,  702,   -1,
  702,  733,  701,   -1,  765,
  703,  734,  702,   -1,   -1,
  704,   -1,   -1,  705,   -1,
  705,  736,  704,   -1,  768,
  706,  737,  705,  707,   -1,
  707,  738,  706,   -1,  770,
  708,  739,  707,  709,   -1,
  709,  740,  708,   -1,  772,
  710,  741,  709,  711,   -1,
  711,  742,  710,   -1,  774,
  712,  743,  711,  713,   -1,
  713,  744,  712,   -1,  776,
  714,  745,  713,  715,   -1,
  715,  746,  714,   -1,  778,
  716,  747,  715,  717,   -1,
  717,  748,  716,   -1,  780,
  718,  749,  717,  719,   -1,
  719,  750,  718,   -1,  782,
  720,  751,  719,  721,   -1,
  721,  752,  720,   -1,  784,
  722,  753,  721,  723,   -1,
  723,  754,  722,   -1,  786,
  724,  755,  723,  725,   -1,
  725,  756,  724,   -1,  788,
  726,  757,  725,  727,   -1,
  727,  758,  726,   -1,  790,
  728,  759,  727,  729,   -1,
  729,  760,  728,   -1,  792,
  730,  761,  729,  731,   -1,
  731,  762,  730,   -1,  794,
  732,  763,  731,  733,   -1,
  733,  764,  732,   -1,  796,
  734,  765,  733,  735,   -1,
  735,  766,  734,   -1,  798,
  736,   -1,   -1,   -1,   -1,
  737,  768,  736,  738,   -1,
  738,  769,  737,   -1,  801,
  739,  770,  738,  740,   -1,
  740,  771,  739,   -1,  803,
  741,  772,  740,  742,   -1,
  742,  773,  741,   -1,  805,
  743,  774,  742,  744,   -1,
  744,  775,  743,   -1,  807,
  745,  776,  744,  746,   -1,
  746,  777,  745,   -1,  809,
  747,  778,  746,  748,   -1,
  748,  779,  747,   -1,  811,
  749,  780,  748,  750,   -1,
  750,  781,  749,   -1,  813,
  751,  782,  750,  752,   -1,
  752,  783,  751,   -1,  815,
  753,  784,  752,  754,   -1,
  754,  785,  753,   -1,  817,
  755,  786,  754,  756,   -1,
  756,  787,  755,   -1,  819,
  757,  788,  756,  758,   -1,
  758,  789,  757,   -1,  821,
  759,  790,  758,  760,   -1,
  760,  791,  759,   -1,  823,
  761,  792,  760,  762,   -1,
  762,  793,  761,   -1,  825,
  763,  794,  762,  764,   -1,
  764,  795,  763,   -1,  827,
  765,  796,  764,  766,   -1,
  766,  797,  765,   -1,  829,
  767,  798,  766,   -1,   -1,
  768,   -1,   -1,  769,   -1,
  769,  800,  768,   -1,  832,
  770,  801,  769,  771,   -1,
  771,  802,  770,   -1,  834,
  772,  803,  771,  773,   -1,
  773,  804,  772,   -1,  836,
  774,  805,  773,  775,   -1,
  775,  806,  774,   -1,  838,
  776,  807,  775,  777,   -1,
  777,  808,  776,   -1,  840,
  778,  809,  777,  779,   -1,
  779,  810,  778,   -1,  842,
  780,  811,  779,  781,   -1,
  781,  812,  780,   -1,  844,
  782,  813,  781,  783,   -1,
  783,  814,  782,   -1,  846,
  784,  815,  783,  785,   -1,
  785,  816,  784,   -1,  848,
  786,  817,  785,  787,   -1,
  787,  818,  786,   -1,  850,
  788,  819,  787,  789,   -1,
  789,  820,  788,   -1,  852,
  790,  821,  789,  791,   -1,
  791,  822,  790,   -1,  854,
  792,  823,  791,  793,   -1,
  793,  824,  792,   -1,  856,
  794,  825,  793,  795,   -1,
  795,  826,  794,   -1,  858,
  796,  827,  795,  797,   -1,
  797,  828,  796,   -1,  860,
  798,  829,  797,  799,   -1,
  799,  830,  798,   -1,  862,
  800,   -1,   -1,   -1,   -1,
  801,  832,  800,  802,   -1,
  802,  833,  801,   -1,  865,
  803,  834,  802,  804,   -1,
  804,  835,  803,   -1,  867,
  805,  836,  804,  806,   -1,
  806,  837,  805,   -1,  869,
  807,  838,  806,  808,   -1,
  808,  839,  807,   -1,  871,
  809,  840,  808,  810,   -1,
  810,  841,  809,   -1,  873,
  811,  842,  810,  812,   -1,
  812,  843,  811,   -1,  875,
  813,  844,  812,  814,   -1,
  814,  845,  813,   -1,  877,
  815,  846,  814,  816,   -1,
  816,  847,  815,   -1,  879,
  817,  848,  816,  818,   -1,
  818,  849,  817,   -1,  881,
  819,  850,  818,  820,   -1,
  820,  851,  819,   -1,  883,
  821,  852,  820,  822,   -1,
  822,  853,  821,   -1,  885,
  823,  854,  822,  824,   -1,
  824,  855,  823,   -1,  887,
  825,  856,  824,  826,   -1,
  826,  857,  825,   -1,  889,
  827,  858,  826,  828,   -1,
  828,  859,  827,   -1,  891,
  829,  860,  828,  830,   -1,
  830,  861,  829,   -1,  893,
  831,  862,  830,   -1,   -1,
  832,   -1,   -1,  833,   -1,
  833,  864,  832,   -1,  896,
  834,  865,  833,  835,   -1,
  835,  866,  834,   -1,  898,
  836,  867,  835,  837,   -1,
  837,  868,  836,   -1,  900,
  838,  869,  837,  839,   -1,
  839,  870,  838,   -1,  902,
  840,  871,  839,  841,   -1,
  841,  872,  840,   -1,  904,
  842,  873,  841,  843,   -1,
  843,  874,  842,   -1,  906,
  844,  875,  843,  845,   -1,
  845,  876,  844,   -1,  908,
  846,  877,  845,  847,   -1,
  847,  878,  846,   -1,  910,
  848,  879,  847,  849,   -1,
  849,  880,  848,   -1,  912,
  850,  881,  849,  851,   -1,
  851,  882,  850,   -1,  914,
  852,  883,  851,  853,   -1,
  853,  884,  852,   -1,  916,
  854,  885,  853,  855,   -1,
  855,  886,  854,   -1,  918,
  856,  887,  855,  857,   -1,
  857,  888,  856,   -1,  920,
  858,  889,  857,  859,   -1,
  859,  890,  858,   -1,  922,
  860,  891,  859,  861,   -1,
  861,  892,  860,   -1,  924,
  862,  893,  861,  863,   -1,
  863,  894,  862,   -1,  926,
  864,   -1,   -1,   -1,   -1,
  865,  896,  864,  866,   -1,
  866,  897,  865,   -1,  929,
  867,  898,  866,  868,   -1,
  868,  899,  867,   -1,  931,
  869,  900,  868,  870,   -1,
  870,  901,  869,   -1,  933,
  871,  902,  870,  872,   -1,
  872,  903,  871,   -1,  935,
  873,  904,  872,  874,   -1,
  874,  905,  873,   -1,  937,
  875,  906,  874,  876,   -1,
  876,  907,  875,   -1,  939,
  877,  908,  876,  878,   -1,
  878,  909,  877,   -1,  941,
  879,  910,  878,  880,   -1,
  880,  911,  879,   -1,  943,
  881,  912,  880,  882,   -1,
  882,  913,  881,   -1,  945,
  883,  914,  882,  884,   -1,
  884,  915,  883,   -1,  947,
  885,  916,  884,  886,   -1,
  886,  917,  885,   -1,  949,
  887,  918,  886,  888,   -1,
  888,  919,  887,   -1,  951,
  889,  920,  888,  890,   -1,
  890,  921,  889,   -1,  953,
  891,  922,  890,  892,   -1,
  892,  923,  891,   -1,  955,
  893,  924,  892,  894,   -1,
  894,  925,  893,   -1,  957,
  895,  926,  894,   -1,   -1,
  896,   -1,   -1,  897,   -1,
  897,  928,  896,   -1,  960,
  898,  929,  897,  899,   -1,
  899,  930,  898,   -1,  962,
  900,  931,  899,  901,   -1,
  901,  932,  900,   -1,  964,
  902,  933,  901,  903,   -1,
  903,  934,  902,   -1,  966,
  904,  935,  903,  905,   -1,
  905,  936,  904,   -1,  968,
  906,  937,  905,  907,   -1,
  907,  938,  906,   -1,  970,
  908,  939,  907,  909,   -1,
  909,  940,  908,   -1,  972,
  910,  941,  909,  911,   -1,
  911,  942,  910,   -1,  974,
  912,  943,  911,  913,   -1,
  913,  944,  912,   -1,  976,
  914,  945,  913,  915,   -1,
  915,  946,  914,   -1,  978,
  916,  947,  915,  917,   -1,
  917,  948,  916,   -1,  980,
  918,  949,  917,  919,   -1,
  919,  950,  918,   -1,  982,
  920,  951,  919,  921,   -1,
  921,  952,  920,   -1,  984,
  922,  953,  921,  923,   -1,
  923,  954,  922,   -1,  986,
  924,  955,  923,  925,   -1,
  925,  956,  924,   -1,  988,
  926,  957,  925,  927,   -1,
  927,  958,  926,   -1,  990,
  928,   -1,   -1,   -1,   -1,
  929,  960,  928,  930,   -1,
  930,  961,  929,   -1,  993,
  931,  962,  930,  932,   -1,
  932,  963,  931,   -1,  995,
  933,  964,  932,  934,   -1,
  934,  965,  933,   -1,  997,
  935,  966,  934,  936,   -1,
  936,  967,  935,   -1,  999,
  937,  968,  936,  938,   -1,
  938,  969,  937,   -1, 1001,
  939,  970,  938,  940,   -1,
  940,  971,  939,   -1, 1003,
  941,  972,  940,  942,   -1,
  942,  973,  941,   -1, 1005,
  943,  974,  942,  944,   -1,
  944,  975,  943,   -1, 1007,
  945,  976,  944,  946,   -1,
  946,  977,  945,   -1, 1009,
  947,  978,  946,  948,   -1,
  948,  979,  947,   -1, 1011,
  949,  980,  948,  950,   -1,
  950,  981,  949,   -1, 1013,
  951,  982,  950,  952,   -1,
  952,  983,  951,   -1, 1015,
  953,  984,  952,  954,   -1,
  954,  985,  953,   -1, 1017,
  955,  986,  954,  956,   -1,
  956,  987,  955,   -1, 1019,
  957,  988,  956,  958,   -1,
  958,  989,  957,   -1, 1021,
  959,  990,  958,   -1,   -1,
  960,   -1,   -1,  961,   -1,
  961,  992,  960,   -1,   -1,
  962,  993,  961,  963,   -1,
  963,  994,  962,   -1,   -1,
  964,  995,  963,  965,   -1,
  965,  996,  964,   -1,   -1,
  966,  997,  965,  967,   -1,
  967,  998,  966,   -1,   -1,
  968,  999,  967,  969,   -1,
  969, 1000,  968,   -1,   -1,
  970, 1001,  969,  971,   -1,
  971, 1002,  970,   -1,   -1,
  972, 1003,  971,  973,   -1,
  973, 1004,  972,   -1,   -1,
  974, 1005,  973,  975,   -1,
  975, 1006,  974,   -1,   -1,
  976, 1007,  975,  977,   -1,
  977, 1008,  976,   -1,   -1,
  978, 1009,  977,  979,   -1,
  979, 1010,  978,   -1,   -1,
  980, 1011,  979,  981,   -1,
  981, 1012,  980,   -1,   -1,
  982, 1013,  981,  983,   -1,
  983, 1014,  982,   -1,   -1,
  984, 1015,  983,  985,   -1,
  985, 1016,  984,   -1,   -1,
  986, 1017,  985,  987,   -1,
  987, 1018,  986,   -1,   -1,
  988, 1019,  987,  989,   -1,
  989, 1020,  988,   -1,   -1,
  990, 1021,  989,  991,   -1,
  991, 1022,  990,   -1,   -1,
};
#endif

const int *vp9_get_coef_neighbors_handle(const int *scan) {
  if (scan == vp9_default_zig_zag1d) {
    return vp9_default_zig_zag1d_neighbors;
  } else if (scan == vp9_row_scan) {
    return vp9_row_scan_neighbors;
  } else if (scan == vp9_col_scan) {
    return vp9_col_scan_neighbors;
  } else if (scan == vp9_default_zig_zag1d_8x8) {
    return vp9_default_zig_zag1d_8x8_neighbors;
  } else if (scan == vp9_default_zig_zag1d_16x16) {
    return vp9_default_zig_zag1d_16x16_neighbors;
#if CONFIG_TX32X32
  } else if (scan == vp9_default_zig_zag1d_32x32) {
    return vp9_default_zig_zag1d_32x32_neighbors;
#endif
  }
}

int vp9_get_coef_neighbor_context(const short int *qcoeff_ptr, int nodc,
                                  const int *neigbor_handle, int rc) {
  static int neighbors_used = MAX_NEIGHBORS;   // maximum is MAX_NEIGHBORS
  const int *nb = neigbor_handle + rc * MAX_NEIGHBORS;
  int i, v, val = 0, n = 0;
  for (i = 0; i < neighbors_used; ++i) {
    if (nb[i] == -1 || (nb[i] == 0 && nodc)) {
      continue;
    }
    v = abs(qcoeff_ptr[nb[i]]);
    val = (v > val ? v : val);
    // val += v;
    n++;
  }
  assert(n > 0);
  // val = (val + n/2) / n;
  if (val <= 1)
    return val;
  else if (val < 4)
    return 2;
  else
    return 3;
}
#endif  /* CONFIG_NEWCOEFCONTEXT */

void vp9_default_coef_probs(VP9_COMMON *pc) {
  vpx_memcpy(pc->fc.coef_probs_4x4, default_coef_probs_4x4,
             sizeof(pc->fc.coef_probs_4x4));
  vpx_memcpy(pc->fc.hybrid_coef_probs_4x4, default_hybrid_coef_probs_4x4,
             sizeof(pc->fc.hybrid_coef_probs_4x4));

  vpx_memcpy(pc->fc.coef_probs_8x8, default_coef_probs_8x8,
             sizeof(pc->fc.coef_probs_8x8));
  vpx_memcpy(pc->fc.hybrid_coef_probs_8x8, default_hybrid_coef_probs_8x8,
             sizeof(pc->fc.hybrid_coef_probs_8x8));

  vpx_memcpy(pc->fc.coef_probs_16x16, default_coef_probs_16x16,
             sizeof(pc->fc.coef_probs_16x16));
  vpx_memcpy(pc->fc.hybrid_coef_probs_16x16,
             default_hybrid_coef_probs_16x16,
             sizeof(pc->fc.hybrid_coef_probs_16x16));

#if CONFIG_TX32X32 && CONFIG_SUPERBLOCKS
  vpx_memcpy(pc->fc.coef_probs_32x32, default_coef_probs_32x32,
             sizeof(pc->fc.coef_probs_32x32));
#endif
}

void vp9_coef_tree_initialize() {
  init_bit_trees();
  vp9_tokens_from_tree(vp9_coef_encodings, vp9_coef_tree);
}

// #define COEF_COUNT_TESTING

#define COEF_COUNT_SAT 24
#define COEF_MAX_UPDATE_FACTOR 112
#define COEF_COUNT_SAT_KEY 24
#define COEF_MAX_UPDATE_FACTOR_KEY 112
#define COEF_COUNT_SAT_AFTER_KEY 24
#define COEF_MAX_UPDATE_FACTOR_AFTER_KEY 128

static void update_coef_probs(vp9_coeff_probs *dst_coef_probs,
                              vp9_coeff_probs *pre_coef_probs,
                              int block_types, vp9_coeff_count *coef_counts,
                              int count_sat, int update_factor) {
  int t, i, j, k, count;
  unsigned int branch_ct[ENTROPY_NODES][2];
  vp9_prob coef_probs[ENTROPY_NODES];
  int factor;

  for (i = 0; i < block_types; ++i)
    for (j = 0; j < COEF_BANDS; ++j)
      for (k = 0; k < PREV_COEF_CONTEXTS; ++k) {
        if (k >= 3 && ((i == 0 && j == 1) || (i > 0 && j == 0)))
          continue;
        vp9_tree_probs_from_distribution(MAX_ENTROPY_TOKENS,
                                         vp9_coef_encodings, vp9_coef_tree,
                                         coef_probs, branch_ct,
                                         coef_counts[i][j][k], 256, 1);
        for (t = 0; t < ENTROPY_NODES; ++t) {
          int prob;
          count = branch_ct[t][0] + branch_ct[t][1];
          count = count > count_sat ? count_sat : count;
          factor = (update_factor * count / count_sat);
          prob = ((int)pre_coef_probs[i][j][k][t] * (256 - factor) +
                  (int)coef_probs[t] * factor + 128) >> 8;
          dst_coef_probs[i][j][k][t] = clip_prob(prob);
        }
      }
}

void vp9_adapt_coef_probs(VP9_COMMON *cm) {
#ifdef COEF_COUNT_TESTING
  int t, i, j, k;
#endif
  int count_sat;
  int update_factor; /* denominator 256 */

  // printf("Frame type: %d\n", cm->frame_type);
  if (cm->frame_type == KEY_FRAME) {
    update_factor = COEF_MAX_UPDATE_FACTOR_KEY;
    count_sat = COEF_COUNT_SAT_KEY;
  } else if (cm->last_frame_type == KEY_FRAME) {
    update_factor = COEF_MAX_UPDATE_FACTOR_AFTER_KEY;  /* adapt quickly */
    count_sat = COEF_COUNT_SAT_AFTER_KEY;
  } else {
    update_factor = COEF_MAX_UPDATE_FACTOR;
    count_sat = COEF_COUNT_SAT;
  }

#ifdef COEF_COUNT_TESTING
  {
    printf("static const unsigned int\ncoef_counts"
           "[BLOCK_TYPES] [COEF_BANDS]"
           "[PREV_COEF_CONTEXTS] [MAX_ENTROPY_TOKENS] = {\n");
    for (i = 0; i < BLOCK_TYPES; ++i) {
      printf("  {\n");
      for (j = 0; j < COEF_BANDS; ++j) {
        printf("    {\n");
        for (k = 0; k < PREV_COEF_CONTEXTS; ++k) {
          printf("      {");
          for (t = 0; t < MAX_ENTROPY_TOKENS; ++t)
            printf("%d, ", cm->fc.coef_counts[i][j][k][t]);
          printf("},\n");
        }
        printf("    },\n");
      }
      printf("  },\n");
    }
    printf("};\n");
    printf("static const unsigned int\ncoef_counts_8x8"
           "[BLOCK_TYPES_8X8] [COEF_BANDS]"
           "[PREV_COEF_CONTEXTS] [MAX_ENTROPY_TOKENS] = {\n");
    for (i = 0; i < BLOCK_TYPES_8X8; ++i) {
      printf("  {\n");
      for (j = 0; j < COEF_BANDS; ++j) {
        printf("    {\n");
        for (k = 0; k < PREV_COEF_CONTEXTS; ++k) {
          printf("      {");
          for (t = 0; t < MAX_ENTROPY_TOKENS; ++t)
            printf("%d, ", cm->fc.coef_counts_8x8[i][j][k][t]);
          printf("},\n");
        }
        printf("    },\n");
      }
      printf("  },\n");
    }
    printf("};\n");
    printf("static const unsigned int\nhybrid_coef_counts"
           "[BLOCK_TYPES] [COEF_BANDS]"
           "[PREV_COEF_CONTEXTS] [MAX_ENTROPY_TOKENS] = {\n");
    for (i = 0; i < BLOCK_TYPES; ++i) {
      printf("  {\n");
      for (j = 0; j < COEF_BANDS; ++j) {
        printf("    {\n");
        for (k = 0; k < PREV_COEF_CONTEXTS; ++k) {
          printf("      {");
          for (t = 0; t < MAX_ENTROPY_TOKENS; ++t)
            printf("%d, ", cm->fc.hybrid_coef_counts[i][j][k][t]);
          printf("},\n");
        }
        printf("    },\n");
      }
      printf("  },\n");
    }
    printf("};\n");
  }
#endif

  update_coef_probs(cm->fc.coef_probs_4x4, cm->fc.pre_coef_probs_4x4,
                    BLOCK_TYPES_4X4, cm->fc.coef_counts_4x4,
                    count_sat, update_factor);
  update_coef_probs(cm->fc.hybrid_coef_probs_4x4,
                    cm->fc.pre_hybrid_coef_probs_4x4,
                    BLOCK_TYPES_4X4, cm->fc.hybrid_coef_counts_4x4,
                    count_sat, update_factor);
  update_coef_probs(cm->fc.coef_probs_8x8, cm->fc.pre_coef_probs_8x8,
                    BLOCK_TYPES_8X8, cm->fc.coef_counts_8x8,
                    count_sat, update_factor);
  update_coef_probs(cm->fc.hybrid_coef_probs_8x8,
                    cm->fc.pre_hybrid_coef_probs_8x8,
                    BLOCK_TYPES_8X8, cm->fc.hybrid_coef_counts_8x8,
                    count_sat, update_factor);
  update_coef_probs(cm->fc.coef_probs_16x16, cm->fc.pre_coef_probs_16x16,
                    BLOCK_TYPES_16X16, cm->fc.coef_counts_16x16,
                    count_sat, update_factor);
  update_coef_probs(cm->fc.hybrid_coef_probs_16x16,
                    cm->fc.pre_hybrid_coef_probs_16x16,
                    BLOCK_TYPES_16X16, cm->fc.hybrid_coef_counts_16x16,
                    count_sat, update_factor);
#if CONFIG_TX32X32 && CONFIG_SUPERBLOCKS
  update_coef_probs(cm->fc.coef_probs_32x32, cm->fc.pre_coef_probs_32x32,
                    BLOCK_TYPES_32X32, cm->fc.coef_counts_32x32,
                    count_sat, update_factor);
#endif
}
